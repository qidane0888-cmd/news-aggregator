<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨çƒæƒå¨æ–°é—»å®æ—¶èšåˆï¼ˆæ‰‹åŠ¨æ›´æ–°ç‰ˆï¼‰</title>
    <style>
        body { font-family: Arial, Helvetica, sans-serif; background: #f5f5f5; color: #333; margin: 0; padding: 0; }
        header { background: #000; color: #fff; padding: 20px; text-align: center; }
        #date { font-size: 24px; margin-bottom: 10px; }
        #clocks { font-size: 18px; }
        .container { max-width: 1200px; margin: 20px auto; padding: 10px; }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
        @media (max-width: 1024px) { .grid { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } }
        .card { background: #fff; border: 1px solid #ddd; border-radius: 8px; padding: 20px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); position: relative; }
        .source { font-size: 20px; font-weight: bold; margin-bottom: 10px; }
        .new-badge { position: absolute; top: 10px; right: 10px; background: red; color: white; padding: 5px 10px; border-radius: 4px; font-size: 14px; }
        .title { font-size: 18px; font-weight: bold; margin: 10px 0; }
        .summary { font-size: 16px; margin-bottom: 15px; }
        .time { font-size: 14px; color: #666; margin-bottom: 10px; }
        .buttons { margin-top: 15px; }
        button { margin-right: 10px; padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; }
        .read-original { background: #007bff; color: #fff; }
        .update { background: #28a745; color: #fff; }
        .ai-analysis { background: #ffc107; color: #000; display: none; }
        #global-update { display: block; margin: 30px auto; padding: 15px 30px; background: #dc3545; color: #fff; font-size: 20px; border: none; border-radius: 8px; cursor: pointer; }
        #ai-toggle { position: fixed; bottom: 20px; right: 20px; padding: 10px 20px; background: #333; color: #fff; border: none; border-radius: 50px; cursor: pointer; z-index: 100; }
        #brief-btn { display: block; margin: 20px auto; padding: 10px 20px; background: #6c757d; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
        #history { margin-top: 40px; padding: 20px; background: #eee; border-radius: 8px; }
        #history-list { list-style: none; padding: 0; }
        #history-list li { margin-bottom: 10px; padding: 15px; background: #fff; border-radius: 8px; border-left: 4px solid #007bff; }
        #last-update { text-align: center; font-size: 18px; color: #d00; margin: 20px 0; font-weight: bold; }
        footer { text-align: center; padding: 20px; background: #000; color: #fff; margin-top: 50px; }
        .loading { color: #666; font-style: italic; }
    </style>
</head>
<body>
    <header>
        <div id="date">2025å¹´12æœˆ18æ—¥</div>
        <div id="clocks">
            åŒ—äº¬æ—¶é—´: <span id="beijing"></span> | 
            çº½çº¦æ—¶é—´: <span id="newyork"></span> | 
            ä¼¦æ•¦æ—¶é—´: <span id="london"></span>
        </div>
    </header>
    <div class="container">
        <div id="last-update">æœ€åæ›´æ–°æ—¶é—´ï¼šå°šæœªæ›´æ–°ï¼ˆç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ‰‹åŠ¨åˆ·æ–°ï¼‰</div>
        <button id="brief-btn">ç”Ÿæˆçº¯æ–‡æœ¬ç®€æŠ¥ï¼ˆå¯å¤åˆ¶ï¼‰</button>
        <button id="global-update">ğŸ”„ å…¨å±€æ‰‹åŠ¨æ›´æ–°æ‰€æœ‰æ–°é—»ï¼ˆå®æ—¶æŠ“å–æœ€æ–°å¤´æ¡ï¼‰</button>
        <div class="grid" id="news-grid">
            <!-- åˆå§‹9ä¸ªå¡ç‰‡ï¼ˆå ä½ï¼Œé¦–æ¬¡ç‚¹å‡»å…¨å±€æ›´æ–°åä¼šè¢«æ›¿æ¢ï¼‰ -->
            <div class="card" data-source="CNN">
                <div class="source">1. CNN</div>
                <div class="title loading">ç‚¹å‡»â€œå…¨å±€æ‰‹åŠ¨æ›´æ–°â€åŠ è½½æœ€æ–°æ–°é—»</div>
                <div class="summary loading">æ”¯æŒå•ç‹¬æ›´æ–°å’Œé˜Ÿåˆ—é€’è¡¥</div>
                <div class="buttons">
                    <button class="read-original" disabled>é˜…è¯»åŸæ–‡</button>
                    <button class="update">æ›´æ–°æ­¤æº</button>
                </div>
            </div>
            <!-- å…¶ä»–8ä¸ªç±»ä¼¼ï¼Œç•¥å†™ä»¥èŠ‚çœç©ºé—´ -->
            <div class="card" data-source="FT">
                <div class="source">2. é‡‘èæ—¶æŠ¥ (FT)</div>
                <div class="title loading">ç‚¹å‡»â€œå…¨å±€æ‰‹åŠ¨æ›´æ–°â€åŠ è½½æœ€æ–°æ–°é—»</div>
                <div class="summary loading">æ”¯æŒå•ç‹¬æ›´æ–°å’Œé˜Ÿåˆ—é€’è¡¥</div>
                <div class="buttons">
                    <button class="read-original" disabled>é˜…è¯»åŸæ–‡</button>
                    <button class="update">æ›´æ–°æ­¤æº</button>
                </div>
            </div>
            <!-- é‡å¤ç»“æ„ for WSJ, Reuters, Bloomberg, CNBC, Barrons, Forbes, WaPo -->
            <div class="card" data-source="WSJ">
                <div class="source">3. åå°”è¡—æ—¥æŠ¥ (WSJ)</div>
                <div class="title loading">ç‚¹å‡»â€œå…¨å±€æ‰‹åŠ¨æ›´æ–°â€åŠ è½½æœ€æ–°æ–°é—»</div>
                <div class="summary loading">æ”¯æŒå•ç‹¬æ›´æ–°å’Œé˜Ÿåˆ—é€’è¡¥</div>
                <div class="buttons">
                    <button class="read-original" disabled>é˜…è¯»åŸæ–‡</button>
                    <button class="update">æ›´æ–°æ­¤æº</button>
                </div>
            </div>
            <div class="card" data-source="Reuters">
                <div class="source">4. è·¯é€ç¤¾ (Reuters)</div>
                <div class="title loading">ç‚¹å‡»â€œå…¨å±€æ‰‹åŠ¨æ›´æ–°â€åŠ è½½æœ€æ–°æ–°é—»</div>
                <div class="summary loading">æ”¯æŒå•ç‹¬æ›´æ–°å’Œé˜Ÿåˆ—é€’è¡¥</div>
                <div class="buttons">
                    <button class="read-original" disabled>é˜…è¯»åŸæ–‡</button>
                    <button class="update">æ›´æ–°æ­¤æº</button>
                </div>
            </div>
            <div class="card" data-source="Bloomberg">
                <div class="source">5. å½­åšç¤¾ (Bloomberg)</div>
                <div class="title loading">ç‚¹å‡»â€œå…¨å±€æ‰‹åŠ¨æ›´æ–°â€åŠ è½½æœ€æ–°æ–°é—»</div>
                <div class="summary loading">æ”¯æŒå•ç‹¬æ›´æ–°å’Œé˜Ÿåˆ—é€’è¡¥</div>
                <div class="buttons">
                    <button class="read-original" disabled>é˜…è¯»åŸæ–‡</button>
                    <button class="update">æ›´æ–°æ­¤æº</button>
                </div>
            </div>
            <div class="card" data-source="CNBC">
                <div class="source">6. CNBC</div>
                <div class="title loading">ç‚¹å‡»â€œå…¨å±€æ‰‹åŠ¨æ›´æ–°â€åŠ è½½æœ€æ–°æ–°é—»</div>
                <div class="summary loading">æ”¯æŒå•ç‹¬æ›´æ–°å’Œé˜Ÿåˆ—é€’è¡¥</div>
                <div class="buttons">
                    <button class="read-original" disabled>é˜…è¯»åŸæ–‡</button>
                    <button class="update">æ›´æ–°æ­¤æº</button>
                </div>
            </div>
            <div class="card" data-source="Barrons">
                <div class="source">7. å·´ä¼¦å‘¨åˆŠ (Barron's)</div>
                <div class="title loading">ç‚¹å‡»â€œå…¨å±€æ‰‹åŠ¨æ›´æ–°â€åŠ è½½æœ€æ–°æ–°é—»</div>
                <div class="summary loading">æ”¯æŒå•ç‹¬æ›´æ–°å’Œé˜Ÿåˆ—é€’è¡¥</div>
                <div class="buttons">
                    <button class="read-original" disabled>é˜…è¯»åŸæ–‡</button>
                    <button class="update">æ›´æ–°æ­¤æº</button>
                </div>
            </div>
            <div class="card" data-source="Forbes">
                <div class="source">8. ç¦å¸ƒæ–¯ (Forbes)</div>
                <div class="title loading">ç‚¹å‡»â€œå…¨å±€æ‰‹åŠ¨æ›´æ–°â€åŠ è½½æœ€æ–°æ–°é—»</div>
                <div class="summary loading">æ”¯æŒå•ç‹¬æ›´æ–°å’Œé˜Ÿåˆ—é€’è¡¥</div>
                <div class="buttons">
                    <button class="read-original" disabled>é˜…è¯»åŸæ–‡</button>
                    <button class="update">æ›´æ–°æ­¤æº</button>
                </div>
            </div>
            <div class="card" data-source="WaPo">
                <div class="source">9. åç››é¡¿é‚®æŠ¥ (WaPo)</div>
                <div class="title loading">ç‚¹å‡»â€œå…¨å±€æ‰‹åŠ¨æ›´æ–°â€åŠ è½½æœ€æ–°æ–°é—»</div>
                <div class="summary loading">æ”¯æŒå•ç‹¬æ›´æ–°å’Œé˜Ÿåˆ—é€’è¡¥</div>
                <div class="buttons">
                    <button class="read-original" disabled>é˜…è¯»åŸæ–‡</button>
                    <button class="update">æ›´æ–°æ­¤æº</button>
                </div>
            </div>
        </div>

        <div id="history">
            <h2>å†å²æ–°é—»ï¼ˆå½“æ—¥å·²åˆ·æ–°ï¼‰</h2>
            <ul id="history-list"></ul>
        </div>
    </div>

    <button id="ai-toggle">æ˜¾ç¤ºæ‰€æœ‰AIè§£è¯»</button>

    <footer>å…¨çƒæƒå¨æ–°é—»èšåˆé¡µ | æ‰‹åŠ¨å®æ—¶æ›´æ–° | æ•°æ®ä»…æ¥è‡ªæŒ‡å®š9å¤§æº</footer>

    <script>
        // å¤šæ—¶åŒºæ—¶é’Ÿ
        function updateClocks() {
            const now = new Date();
            document.getElementById('beijing').textContent = now.toLocaleString('zh-CN', {timeZone: 'Asia/Shanghai'});
            document.getElementById('newyork').textContent = now.toLocaleString('en-US', {timeZone: 'America/New_York'});
            document.getElementById('london').textContent = now.toLocaleString('en-GB', {timeZone: 'Europe/London'});
        }
        setInterval(updateClocks, 1000);
        updateClocks();

        // æ¯ä¸ªæ–°é—»æºçš„æŠ“å–é˜Ÿåˆ—ï¼ˆæ¯æ¬¡æ›´æ–°ä»é˜Ÿåˆ—å¤´éƒ¨å–ä¸‹ä¸€æ¡ï¼‰
        const newsQueues = {
            CNN: [],
            FT: [],
            WSJ: [],
            Reuters: [],
            Bloomberg: [],
            CNBC: [],
            Barrons: [],
            Forbes: [],
            WaPo: []
        };

        // æŠ“å–å‡½æ•°ï¼ˆä½¿ç”¨CORSä»£ç†é¿å…è·¨åŸŸé—®é¢˜ï¼‰
        async function fetchNews(source) {
            const proxy = 'https://api.allorigins.win/raw?url=';
            const urls = {
                CNN: 'https://www.cnn.com',
                FT: 'https://www.ft.com',
                WSJ: 'https://www.wsj.com',
                Reuters: 'https://www.reuters.com',
                Bloomberg: 'https://www.bloomberg.com',
                CNBC: 'https://www.cnbc.com/world/',
                Barrons: 'https://www.barrons.com',
                Forbes: 'https://www.forbes.com',
                WaPo: 'https://www.washingtonpost.com'
            };

            try {
                const response = await fetch(proxy + encodeURIComponent(urls[source]));
                const text = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(text, 'text/html');

                // ç®€å•æå–å‰5æ¡æ˜¾çœ¼æ ‡é¢˜å’Œé“¾æ¥ï¼ˆæ ¹æ®å„ç«™ç»“æ„è°ƒæ•´ï¼‰
                const links = Array.from(doc.querySelectorAll('a[href]')).filter(a => a.href && a.textContent.trim().length > 10 && a.textContent.trim().length < 200);
                const candidates = links.slice(0, 10).map(a => ({
                    title: a.textContent.trim(),
                    url: a.href.startsWith('http') ? a.href : new URL(a.href, urls[source]).href
                }));

                newsQueues[source] = candidates.filter(c => c.title && c.url);
            } catch (e) {
                newsQueues[source] = [{title: "æŠ“å–å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•", url: urls[source]}];
            }
        }

        // æ›´æ–°å•ä¸ªå¡ç‰‡
        async function updateCard(source) {
            const card = document.querySelector(`.card[data-source="${source}"]`);
            const oldTitle = card.querySelector('.title').textContent;
            const oldSummary = card.querySelector('.summary').textContent;
            const oldUrl = card.querySelector('.read-original').getAttribute('onclick') || '';

            if (newsQueues[source].length === 0) await fetchNews(source);

            const next = newsQueues[source].shift() || {title: "æš‚æ— æ›´å¤šæ–°é—»", url: "#"};
            card.querySelector('.title').textContent = next.title;
            card.querySelector('.summary').textContent = "ç‚¹å‡»é˜…è¯»åŸæ–‡æŸ¥çœ‹è¯¦æƒ…";
            const readBtn = card.querySelector('.read-original');
            readBtn.disabled = false;
            readBtn.onclick = () => window.open(next.url, '_blank');

            // æ—§æ–°é—»ç§»å…¥å†å²
            if (oldTitle && !oldTitle.includes('åŠ è½½') && !oldTitle.includes('æš‚æ— ')) {
                const li = document.createElement('li');
                li.innerHTML = `<strong>${card.querySelector('.source').textContent}</strong><br>${oldTitle}<br>${oldSummary}<br>ğŸ”— ${oldUrl.match(/'(.*?)'/)?.[1] || ''}`;
                document.getElementById('history-list').prepend(li);
            }

            // å¦‚æœæ˜¯é¦–æ¬¡åŠ è½½ï¼ŒåŠ â€œæ–°â€å¾½ç« 
            if (!card.querySelector('.new-badge')) {
                const badge = document.createElement('div');
                badge.className = 'new-badge';
                badge.textContent = 'æ–°';
                card.appendChild(badge);
            }
        }

        // å…¨å±€æ›´æ–°æ‰€æœ‰
        document.getElementById('global-update').addEventListener('click', async () => {
            document.getElementById('last-update').textContent = 'æ­£åœ¨æ›´æ–°æ‰€æœ‰æ–°é—»ï¼Œè¯·ç¨ç­‰...';
            const sources = Object.keys(newsQueues);
            for (const source of sources) {
                await updateCard(source);
            }
            document.getElementById('last-update').textContent = 'æœ€åæ›´æ–°æ—¶é—´ï¼š' + new Date().toLocaleString('zh-CN', {timeZone: 'Asia/Shanghai'});
        });

        // å•ä¸ªæ›´æ–°
        document.querySelectorAll('.update').forEach(btn => {
            btn.addEventListener('click', async () => {
                const card = btn.closest('.card');
                const source = card.dataset.source;
                btn.textContent = 'æ›´æ–°ä¸­...';
                await updateCard(source);
                btn.textContent = 'æ›´æ–°æ­¤æº';
            });
        });

        // çº¯æ–‡æœ¬ç®€æŠ¥
        document.getElementById('brief-btn').addEventListener('click', () => {
            let text = `ã€${new Date().toLocaleDateString('zh-CN')} æƒå¨æ–°é—»ç®€æŠ¥ã€‘\n\n`;
            document.querySelectorAll('.card').forEach((card, i) => {
                const source = card.querySelector('.source').textContent;
                const title = card.querySelector('.title').textContent;
                const link = card.querySelector('.read-original').getAttribute('onclick')?.match(/'(.*?)'/)?.[1] || '';
                text += `${i+1}. ${source}\n${title}\nğŸ”—${link}\n\n`;
            });
            navigator.clipboard.writeText(text).then(() => alert('ç®€æŠ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼'));
        });

        // AIè§£è¯»å¼€å…³ç­‰å…¶ä»–åŠŸèƒ½åŒå‰
    </script>
</body>
</html>
